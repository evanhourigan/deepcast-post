# Deepcast Post

A CLI tool for generating deepcast breakdowns from diarized transcripts using OpenAI API.

## Overview

This tool takes a diarized transcript (typically generated by the `diarized-transcriber` tool) and generates a comprehensive deepcast breakdown that includes:

- Full thematic breakdown of the episode's main ideas and arguments
- Timestamped key takeaways for each major point
- Speaker-organized notes with contributions, perspective, and tone
- Extracted quotes with timestamps
- Executive summary suitable for presentations

## Cost & Model Information

**Default Model**: GPT-4o-mini (cost-effective for transcript analysis)

| Model           | Input Cost          | Output Cost         | Cost per Transcript | Best For                       |
| --------------- | ------------------- | ------------------- | ------------------- | ------------------------------ |
| GPT-4o          | $5.00/1M tokens     | $15.00/1M tokens    | ~$0.11              | Complex analysis, high quality |
| **GPT-4o Mini** | **$0.15/1M tokens** | **$0.60/1M tokens** | **~$0.004**         | **Cost-effective analysis** ⭐ |
| GPT-3.5 Turbo   | $0.50/1M tokens     | $1.50/1M tokens     | ~$0.011             | Basic tasks                    |

_For detailed cost analysis and recommendations, see [COST_GUIDE.md](COST_GUIDE.md)_

## Sample Input → Output

### Input (Transcript Excerpt)

```
[00:00:00] Speaker A: Welcome to the podcast everyone.
[00:00:05] Speaker B: Thanks for having us.
[00:00:10] Speaker A: Today we're discussing AI and its impact on society.
[00:00:15] Speaker B: It's a fascinating topic that affects us all.
[00:00:20] Speaker A: Let's dive into the main themes.
```

### Output (Executive Summary)

```
## Executive Summary

- **AI Ethics Focus:** Discussion centers on responsible AI development and deployment
- **Societal Impact:** AI affects all communities and requires careful consideration
- **Expert Perspectives:** Host and guest provide balanced technical and industry insights
- **Future Outlook:** Rapid advancement necessitates proactive policy and ethical frameworks
- **Balanced Approach:** Need for innovation while maintaining human-centric AI development
```

## Installation

### Using Poetry (Recommended)

```bash
# Install dependencies
poetry install

# Install the CLI tool
poetry install
```

### Using pip

```bash
pip install -r requirements.txt
```

## Setup

### Environment Variables

1. **Using direnv (Recommended)**:

   ```bash
   # Install direnv if you haven't already
   brew install direnv  # macOS
   # or: sudo apt-get install direnv  # Ubuntu/Debian

   # Copy the example environment file
   cp env.example .env

   # Edit .env with your OpenAI API key
   nano .env
   ```

2. **Using environment variables directly**:

   ```bash
   export OPENAI_API_KEY="your-api-key-here"
   ```

3. **Using a .env file manually**:
   ```bash
   # Create .env file
   echo "OPENAI_API_KEY=your-api-key-here" > .env
   ```

### Virtual Environment

The project uses Poetry for dependency management and direnv for environment management:

```bash
# Install Poetry if you haven't already
curl -sSL https://install.python-poetry.org | python3 -

# Install dependencies and activate virtual environment
poetry install

# Or if you prefer pip:
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

## Usage

### Basic Usage

```bash
# Generate deepcast breakdown from a transcript
deepcast path/to/transcript.txt
```

The tool will:

1. Load the specified transcript file
2. Generate a deepcast breakdown using OpenAI's GPT-4o-mini
3. Save the output as `{transcript}-deepcast.md`

### Command Line Options

```bash
deepcast --help
```

## Workflow Integration

This tool is designed to work as part of a larger podcast processing workflow:

1. **Transcribe & Diarize**: Use `diarized-transcriber` to create a transcript
2. **Generate Deepcast**: Use this tool to create a structured breakdown from the transcript
3. **Import to Notion**: (Future tool) Import the breakdown into Notion

Example workflow:

```bash
# Step 1: Transcribe and diarize
transcribe audio.wav --formats txt

# Step 2: Generate deepcast breakdown
deepcast audio-transcript.txt

# Step 3: Import to Notion (future tool)
# notion-import audio-deepcast.md
```

## Output Format

The tool generates a Markdown file with:

- `##` section headings for thematic breakdowns
- `**Speaker Name:**` for speaker-specific notes
- Bulleted lists for key points
- Timestamps in `[mm:ss]` or `[hh:mm:ss]` format
- Executive summary at the end

## Configuration

The tool uses the following default settings:

- **Model**: GPT-4o-mini (cost-effective for transcript analysis)
- **Temperature**: 0.7
- **Output suffix**: `-deepcast.md`

## Development

```bash
# Install development dependencies
poetry install

# Run tests
poetry run pytest

# Run tests with coverage
poetry run pytest --cov=deepcast_post --cov-report=term-missing

# Build the package
poetry build
```

Testing configuration is defined under `[tool.pytest.ini_options]` in `pyproject.toml`. See `TESTING.md` for detailed testing documentation.

## License

MIT License