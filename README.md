# Deepcast Post

A CLI tool for generating deepcast breakdowns from diarized transcripts using OpenAI API.

## Overview

This tool takes a diarized transcript (typically generated by the `diarized-transcriber` tool) and generates a comprehensive deepcast breakdown that includes:

- Full thematic breakdown of the episode's main ideas and arguments
- Timestamped key takeaways for each major point
- Speaker-organized notes with contributions, perspective, and tone
- Extracted quotes with timestamps
- Executive summary suitable for presentations

## Installation

### Using Poetry (Recommended)

```bash
# Install dependencies
poetry install

# Install the CLI tool
poetry install
```

### Using pip

```bash
pip install -r requirements.txt
```

## Setup

### Environment Variables

1. **Using direnv (Recommended)**:

   ```bash
   # Install direnv if you haven't already
   brew install direnv  # macOS
   # or: sudo apt-get install direnv  # Ubuntu/Debian

   # Copy the example environment file
   cp env.example .env

   # Edit .env with your OpenAI API key
   nano .env
   ```

2. **Using environment variables directly**:

   ```bash
   export OPENAI_API_KEY="your-api-key-here"
   ```

3. **Using a .env file manually**:
   ```bash
   # Create .env file
   echo "OPENAI_API_KEY=your-api-key-here" > .env
   ```

### Virtual Environment

The project uses Poetry for dependency management and direnv for environment management:

```bash
# Install Poetry if you haven't already
curl -sSL https://install.python-poetry.org | python3 -

# Install dependencies and activate virtual environment
poetry install

# Or if you prefer pip:
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

## Usage

### Basic Usage

```bash
# Generate deepcast breakdown from a transcript
deepcast path/to/transcript.txt
```

The tool will:

1. Load the specified transcript file
2. Generate a deepcast breakdown using OpenAI's GPT-4o-mini
3. Save the output as `{transcript}-deepcast.md`

### Command Line Options

```bash
deepcast --help
```

## Workflow Integration

This tool is designed to work as part of a larger podcast processing workflow:

1. **Transcribe & Diarize**: Use `diarized-transcriber` to create a transcript
2. **Generate Deepcast**: Use this tool to create a structured breakdown from the transcript
3. **Import to Notion**: (Future tool) Import the breakdown into Notion

Example workflow:

```bash
# Step 1: Transcribe and diarize
transcribe audio.wav --formats txt

# Step 2: Generate deepcast breakdown
deepcast audio-transcript.txt

# Step 3: Import to Notion (future tool)
# notion-import audio-deepcast.md
```

## Output Format

The tool generates a Markdown file with:

- `##` section headings for thematic breakdowns
- `**Speaker Name:**` for speaker-specific notes
- Bulleted lists for key points
- Timestamps in `[mm:ss]` or `[hh:mm:ss]` format
- Executive summary at the end

## Configuration

The tool uses the following default settings:

- **Model**: GPT-4o-mini (cost-effective for transcript analysis)
- **Temperature**: 0.7
- **Output suffix**: `-deepcast.md`

## Development

```bash
# Install development dependencies
poetry install

# Run tests
poetry run pytest

# Run tests with coverage
poetry run pytest --cov=deepcast_post --cov-report=term-missing

# Build the package
poetry build
```

Testing configuration is defined under `[tool.pytest.ini_options]` in `pyproject.toml`. See `TESTING.md` for detailed testing documentation.

## License

MIT License
